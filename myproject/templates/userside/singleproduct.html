{% extends 'userside/base.html' %}
{% block content %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Name - Halloween Costumes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
     <style>
        
body {
    font-family: Arial, sans-serif;
    background-color: #1a1a1a;
    color: #ddd;
    margin: 0;
    padding: 0;
	background-color: #000;
	}	    
h1,h2,h3,h4,h5,h6{
			        
		color: #e0f7e8; /* Light green color */
		font-family: 'Creepster', cursive; /* or your desired font */
		margin-bottom: 20px; /* Adjust as needed */
}


.dark-theme a {
    color: #38ff70;
    text-decoration: none;
}

.dark-theme a:hover {
    color: #25c654;
}

.breadcrumb {
    padding: 10px 20px;
    font-size: 14px;
    color: #38ff70;
}

/* Product Container */
.product-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    padding: 20px;
    max-width: 1200px;
    margin: auto;
}

.image-gallery {
    flex: 1 1 40%;
    max-width: 500px;
    padding: 10px;
}

.main-image {
    width: 100%;
    border-radius: 5px;
}

.thumbnail-images {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.thumbnail {
    width: 70px;
    height: 70px;
    border-radius: 5px;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.3s;
}

.thumbnail:hover {
    opacity: 1;
}

.product-details {
    flex: 1 1 50%;
    max-width: 500px;
    padding: 10px 20px;
}

.product-details h1 {
    font-size: 28px;
    color: #38ff70;
    margin: 0;
}

.price {
    font-size: 24px;
    color: #ffab3d;
    margin: 10px 0;
}

.description {
    font-size: 16px;
    line-height: 1.6;
}

/* Variant Options */
.variants {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 15px;
}

.variants label {
    color: #ddd;
    font-weight: bold;
    margin-right: 10px;
}

.variants select {
    padding: 8px;
    background: #333;
    color: #ddd;
    border: 1px solid #555;
    border-radius: 5px;
}

/* Quantity Selector */
.quantity-selector {
    display: flex;
    align-items: center;
    margin-top: 15px;
}

.quantity-selector button {
    background-color: #333;
    color: #ddd;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 18px;
    border-radius: 5px;
    transition: background 0.3s;
}

.quantity-selector button:hover {
    background-color: #555;
}

.quantity-selector input {
    width: 50px;
    text-align: center;
    font-size: 18px;
    margin: 0 5px;
    border: 1px solid #555;
    background: #333;
    color: #ddd;
    border-radius: 5px;
}

/* Add to Cart Button */
.add-to-cart-button {
    background-color: #38ff70;
    color: #1a1a1a;
    padding: 12px 20px;
    font-size: 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 20px;
    display: block;
    transition: background 0.3s;
}

.add-to-cart-button:hover {
    background-color: #25c654;
}

/* Related Products */
.related-products {
    max-width: 1200px;
    margin: 40px auto;
    padding: 0 20px;
    text-align: center;
}

.related-products h2 {
    color: #38ff70;
    font-size: 24px;
    margin-bottom: 20px;
}

.related-product-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
}

.product-item {
    background: #333;
    color: #ddd;
    padding: 10px;
    border-radius: 5px;
    text-align: center;
    width: 150px;
}

.product-item img {
    width: 100%;
    border-radius: 5px;
}

.product-item .product-name {
    font-size: 16px;
    margin: 10px 0 5px;
}

.product-item .product-price {
    font-size: 14px;
    color: #ffab3d;
}

/* Responsive Design */
@media (max-width: 768px) {
    .product-container {
        flex-direction: column;
    }
    .image-gallery, .product-details {
        max-width: 100%;
    }
}

.navbar-logo a {
    color: white;
    font-size: 24px;
    text-decoration: none;
}

.navbar-menu {
    display: flex;
    list-style: none;
}

.navbar-menu li {
    margin: 0 15px;
}

.navbar-menu a {
    color: white;
    text-decoration: none;
    transition: color 0.3s;
}

.navbar-menu a:hover {
    color: #ff6347;
}

.navbar-toggle {
    display: none;
    flex-direction: column;
    cursor: pointer;
}

.bar {
    height: 4px;
    width: 25px;
    background-color: white;
    margin: 4px 0;
}

/* Responsive styles */
@media (max-width: 768px) {
    .navbar-menu {
        display: none;
        flex-direction: column;
        width: 100%;
        background-color: #333;
        position: absolute;
        top: 60px;
        left: 0;
    }

    .navbar-menu.active {
        display: flex;
    }

    .navbar-toggle {
        display: flex;
    }
}
.navbar-menu {
    list-style-type: none;
    display: flex;
    gap: 20px;
}

.navbar-menu li {
    position: relative;
}

.navbar-menu a {
    text-decoration: none;
    color:  wheat;
    padding: 10px 15px;
    display: inline-block;
}

.dropdown-content {
    display: none; /* Hide by default */
    position: absolute;
    top: 100%; /* Position below the menu item */
    left: -50px;
    background-color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    padding: 10px;
    border-radius: 5px;
    min-width: 150px;
    z-index: 100;
}

.dropdown-content a {
    display: block;
    padding: 10px;
    color: #333;
    text-decoration: none;
}

.dropdown-content a:hover {
    background-color: #f0f0f0; /* Add background on hover */
}

.dropdown:hover .dropdown-content {
    display: block; /* Show dropdown on hover */
}

.footer {
    background-color: #222; /* Dark background */
    color: #fff; /* White text */
    padding: 50px 0; /* Padding for top and bottom */
}

.footer-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap; /* Wrap items on smaller screens */
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.footer-section {
    flex: 1;
    min-width: 200px;
    margin: 20px 0;
}

.footer-section h3 {
    font-size: 1.5rem;
    color: #ff4800; /* Footer section header color */
    margin-bottom: 20px;
}

.footer-section p, .footer-section a {
    color: #aaa;
    font-size: 1rem;
    margin-bottom: 10px;
    text-decoration: none;
    transition: color 0.3s;
}

.footer-section a:hover {
    color: #ff4800; /* Link hover color */
}

.social-links {
    list-style: none;
    padding: 0;
}

.social-links li {
    display: inline;
    margin-right: 15px;
}

.footer-bottom {
    text-align: center;
    padding: 20px 0;
    border-top: 1px solid #444;
    margin-top: 30px;
    color: #aaa;
}

/* Footer Styles */
footer {
    background-color: #1a1a1a;
    color: #ddd;
    padding: 40px 0;
    font-family: Arial, sans-serif;
}

.footer-content {
    display: flex;
    flex-wrap: wrap;
    max-width: 1200px;
    margin: auto;
    justify-content: space-between;
    padding: 0 20px;
}

.footer-section {
    flex: 1 1 200px;
    margin-bottom: 20px;
}

.footer-section h4 {
    font-size: 18px;
    color: #38ff70;
    margin-bottom: 15px;
}

.footer-section p,
.footer-section ul,
.footer-section a {
    font-size: 14px;
    line-height: 1.6;
    color: #ddd;
    margin: 0;
}

.footer-section ul {
    list-style-type: none;
    padding: 0;
}

.footer-section ul li {
    margin-bottom: 8px;
}

.footer-section ul li a {
    color: #ddd;
    text-decoration: none;
    transition: color 0.3s;
}

.footer-section ul li a:hover {
    color: #38ff70;
}

.social-icons {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.social-icons a {
    color: #ddd;
    font-size: 20px;
    transition: color 0.3s;
}

.social-icons a:hover {
    color: #38ff70;
}

/* Responsive Design */
@media (max-width: 768px) {
    .footer-content {
        flex-direction: column;
        align-items: center;
    }
    .footer-section {
        text-align: center;
    }
}

.banner {
    background-color: #4caf50; /* Green background */
    color: white;
    padding: 20px;
    text-align: center;
    margin: 20px 250px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.banner h2 {
    margin: 0;
    font-size: 1.5rem;
}

.banner p {
    margin: 10px 0;
}

.banner .btn {
    background-color: white; /* Button background */
    color: #4caf50; /* Button text color */
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    text-decoration: none;
    transition: background-color 0.3s, color 0.3s;
}

.banner .btn:hover {
    background-color: #f0f0f0; /* Light gray on hover */
    color: #333; /* Darker text on hover */
}

/* Customer Reviews Section Styles */
.comments-section {
    max-width: 800px;
    margin: 40px auto;
    padding: 20px;
    background-color: #1a1a1a;
    color: #ddd;
    border-radius: 8px;
    font-family: Arial, sans-serif;
}

.comments-section h2,
.comments-section h3 {
    color: #38ff70;
    margin-bottom: 20px;
    text-align: center;
}

.reviews {
    margin-bottom: 30px;
}

.review-item {
    padding: 15px;
    background-color: #2b2b2b;
    border-radius: 6px;
    margin-bottom: 20px;
}

.review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.review-author {
    font-weight: bold;
    color: #38ff70;
}

.review-rating i {
    color: #ffcd3c; /* Star color */
    margin-right: 2px;
}

.review-text {
    font-size: 15px;
    line-height: 1.6;
}

.divider {
    border: 0;
    height: 1px;
    background-color: #444;
    margin: 30px 0;
}

.review-form {
    background-color: #2b2b2b;
    padding: 20px;
    border-radius: 6px;
}

.review-form label {
    display: block;
    color: #38ff70;
    margin-bottom: 8px;
    font-weight: bold;
}

.review-form input[type="text"],
.review-form select,
.review-form textarea {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 4px;
    margin-bottom: 15px;
    background-color: #444;
    color: #ddd;
    font-size: 15px;
}

.review-form textarea {
    resize: vertical;
}

.submit-btn {
    display: block;
    width: 100%;
    padding: 12px;
    background-color: #38ff70;
    color: #1a1a1a;
    font-weight: bold;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.submit-btn:hover {
    background-color: #2ecc71;
}

/* Responsive Design */
@media (max-width: 600px) {
    .comments-section {
        padding: 15px;
    }
}
.product-highlights {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background-color: #1a1a1a;
    border-radius: 8px;
    color: #ddd;
}

.product-highlights h2 {
    color: #38ff70;
    margin-bottom: 20px;
    text-align: center;
}

.product-highlights ul {
    list-style: none;
    padding: 0;
}

.product-highlights li {
    padding: 10px 0;
    border-bottom: 1px solid #444;
}

.product-highlights li strong {
    color: #38ff70;
    margin-right: 5px;
}
.product-faq {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background-color: #1a1a1a;
    border-radius: 8px;
    color: #ddd;
}

.product-faq h2 {
    color: #38ff70;
    margin-bottom: 20px;
    text-align: center;
}

.faq-item {
    padding: 15px 0;
    border-bottom: 1px solid #444;
}

.faq-item h4 {
    color: #38ff70;
    margin-bottom: 5px;
}

.faq-item p {
    margin: 0;
    font-size: 15px;
}
.product-specifications {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background-color: #1a1a1a;
    border-radius: 8px;
    color: #ddd;
}

.product-specifications h2 {
    color: #38ff70;
    margin-bottom: 20px;
    text-align: center;
}

.product-specifications table {
    width: 100%;
    border-collapse: collapse;
}

.product-specifications th,
.product-specifications td {
    padding: 10px;
    border-bottom: 1px solid #444;
    text-align: left;
}

.product-specifications th {
    color: #38ff70;
    font-weight: bold;
}

.product-specifications tr:nth-child(even) {
    background-color: #2b2b2b;
}

.product-faq {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background-color: #1a1a1a;
    border-radius: 8px;
    color: #ddd;
}

.product-faq h2, .product-faq h3 {
    color: #38ff70;
    margin-bottom: 20px;
    text-align: center;
}

.faq-item {
    padding: 15px 0;
    border-bottom: 1px solid #444;
}

.faq-item h4 {
    color: #38ff70;
    margin-bottom: 5px;
}

.faq-item p {
    margin: 0;
    font-size: 15px;
}

.faq-question-form {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #444;
}

.faq-question-form h3 {
    margin-bottom: 15px;
}

.faq-question-form form {
    display: flex;
    flex-direction: column;
}

.faq-question-form label {
    color: #38ff70;
    font-size: 14px;
    margin-bottom: 5px;
}

.faq-question-form textarea,
.faq-question-form input[type="email"] {
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #444;
    border-radius: 4px;
    background-color: #2b2b2b;
    color: #ddd;
    font-size: 14px;
    outline: none;
}

.faq-question-form button {
    padding: 10px;
    border: none;
    border-radius: 4px;
    background-color: #38ff70;
    color: #1a1a1a;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.faq-question-form button:hover {
    background-color: #2be65d;
}
.stock:hover {
    background-color: #d4edda; /* Darker green on hover */
    cursor: pointer; /* Change cursor to indicate it's interactive */
}
.shop-now-button {
    background-color: #007bff; /* Blue background */
    color: white; /* White text */
    border: none; /* No border */
    padding: 10px 20px; /* Padding for top/bottom and left/right */
    font-size: 16px; /* Font size */
    font-weight: bold; /* Bold text */
    border-radius: 5px; /* Rounded corners */
    cursor: pointer; /* Pointer cursor on hover */
    transition: background-color 0.3s ease; /* Smooth background color change */
    margin-top: 10px; /* Margin on top for spacing */
}

/* Hover effect for the button */
.shop-now-button:hover {
    background-color: #0056b3; /* Darker blue on hover */
}
.button-container {
    display: flex; /* Use flexbox for layout */
    justify-content: space-between; /* Distribute space between buttons */
    margin-top: 15px; /* Add some margin on top */
}

.add-to-cart-button,
.shop-now-button {
    flex: 1; /* Make buttons take equal space */
    margin: 0 5px; /* Add margin between buttons */
    padding: 12px; /* Increase padding for a larger button */
    font-size: 16px; /* Font size */
    font-weight: bold; /* Bold text */
    border-radius: 5px; /* Rounded corners */
    cursor: pointer; /* Pointer cursor */
    transition: background-color 0.3s ease; /* Smooth background color change */
}

/* Style for Add to Cart Button */
.add-to-cart-button {
    background-color: #28a745; /* Green background */
    color: white; /* White text */
    border: none; /* No border */
}

/* Hover effect for Add to Cart Button */
.add-to-cart-button:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Style for Shop Now Button */
.shop-now-button {
    background-color: #007bff; /* Blue background */
    color: white; /* White text */
    border: none; /* No border */
}

/* Hover effect for Shop Now Button */
.shop-now-button:hover {
    background-color: #0056b3; /* Darker blue on hover */
}
.image-gallery {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.main-image-container {
	position: relative;
	width: 400px; /* Adjust as needed */
	height: 400px;
}

.thumbnail-images {
	display: flex;
	justify-content: center;
	margin-top: 10px;
}

.thumbnail {
	width: 80px; /* Thumbnail size */
	margin: 0 5px;
	cursor: pointer;
}
.review-message {
    margin-top: 10px;
    font-weight: bold;
    padding: 5px;
    border-radius: 3px;
}

.success-message {
    color: green;
}

.error-message {
    color: red;
}
.offcanvas {
    position: fixed;
    top: 0;
    right: -300px; /* Start off-screen */
    width: 300px;
    height: 100%;
    background-color: #fff;
    box-shadow: -2px 0 5px rgba(0, 0, 0, 0.5);
    transition: right 0.3s ease;
    padding: 20px;
    z-index: 1000; /* Ensure it's above other elements */
}

.offcanvas.open {
    right: 0; /* Slide in */
}

.offcanvas-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.cart-total {
    margin-top: 20px;
}
.video-container video {
    width: 100%;
}

.video-container video::-webkit-media-controls {
    display: none; /* For WebKit browsers */
}

.video-container video::-moz-media-controls {
    display: none; /* For Firefox */
}

.video-container video {
    pointer-events: none; /* Prevents controls from showing */
}

.video-container:hover video {
    pointer-events: auto; /* Show controls when hovered */
}


</style>
</head>
<body class="dark-theme">

    


<div class="breadcrumb">
    <a href="home.html">Home</a> / <a href="category.html">Accessories</a> / Product Name
</div>



<div class="product-container">
    {% comment %} <div class="image-gallery">
		<div class="main-image-container">
			<img id="main-image" src="{{ default_variant.images.0.image }}" alt="{{ product.name }}" class="main-image" data-zoom-image="{{ default_variant.images.0.image }}">
		</div>
		<div class="thumbnail-images" id="thumbnail-images">
			{% for image in default_variant.images %}
				<img src="{{ image.image }}" alt="Thumbnail" class="thumbnail" onclick="updateMainImage('{{ image.image }}')">
			{% endfor %}
		</div>
	</div> {% endcomment %}

    <div class="image-gallery">
        <!-- Main Image Container -->
        <div class="main-image-container">
            <img id="main-image" src="{{ default_variant.images.0.image }}" alt="{{ product.name }}" class="main-image" data-zoom-image="{{ default_variant.images.0.image }}">
        </div>
    
        <!-- Thumbnails -->
        <div class="thumbnail-images" id="thumbnail-images">
            {% for image in default_variant.images %}
                <img src="{{ image.image }}" alt="Thumbnail" class="thumbnail" onclick="updateMainImage('{{ image.image }}')">
            {% endfor %}
        </div>
    
        <!-- Video Section (Displayed if videos are available) -->
        {% comment %} {% if variants %}
       <div class="video-gallery">
        <h2>Product Variant Videos</h2>
        {% for variant in variants %}
            {% if variant.video %}
                <div class="video-container">
                    <video controls width="300">
                        <source src="{{ variant.video.url }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <p>Variant - Color: {{ variant.colour }}, Size: {{ variant.size }}, Type: {{ variant.type1 }}</p>
                </div>
            {% endif %}
            {% endfor %}
            </div>
        {% endif %}
    {% endcomment %}

    
    {% if product.video %}
    <video controls width="320" style='margin-top:20px;width:85%;'>
        <source src="{{ product.video.url }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
{% endif %}
	 </div>

    <div class="product-details">
        <h1>{{ product.name }}</h1>
        <p class="price" id="price">${{ default_variant.price }}</p>
        {% comment %} <p class="description" id="description">{{ default_variant.description }}</p> {% endcomment %}
		<p class="stock" id="stock" style="padding: 5px; font-size: 16px;margin-bottom:20px font-weight: bold; border: 2px solid #28a745; color: #28a745; border-radius: 5px; display: inline-block; margin-top: 5px;">
			In Stock: {{ default_variant.stock }}
		</p>

		<p class="description" id="description" style="margin-top:10px;">{{ product.description }}</p>

                <form method="POST" action="">
                    {% csrf_token %}
                    <div class="variants" style="display: flex; flex-direction: column; gap: 15px; max-width: 400px; margin:30px; padding: 20px; border: 1px solid #ddd; border-radius: 10px;">
                        <label for="color">Color:</label>
                        <select name="color" id="color" onchange="updateVariant()">
                            {% for color in unique_colors %}
                                <option value="{{ color }}" {% if color == default_variant.colour %}selected{% endif %}>
                                    {{ color }}
                                </option>
                            {% endfor %}
                        </select>
                        
                        <label for="size">Size:</label>
                        <select name="size" id="size" onchange="updateVariant()">
                            {% for size in unique_sizes %}
                                <option value="{{ size }}" {% if size == default_variant.size %}selected{% endif %}>
                                    {{ size }}
                                </option>
                            {% endfor %}
                        </select>
                        
                        <label for="type">Type:</label>
                        <select name="type" id="type" onchange="updateVariant()">
                            {% for type in unique_types %}
                                <option value="{{ type }}" {% if type == default_variant.type1 %}selected{% endif %}>
                                    {{ type }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                
                    <!-- Hidden input to store selected variant ID -->
                    <input type="hidden" id="selected_variant_id" name="selected_variant_id" value="{{ default_variant.id }}">
                </form>
                
                {% comment %} <div class="quantity-selector" style="margin: 20px 0;">
                    <label for="quantity">Quantity:</label>
                    <button type="button" onclick="changeQuantity(-1)">-</button>
                    <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ default_variant.stock }}" style="width: 50px;">
                    <button type="button" onclick="changeQuantity(1)">+</button>
                </div> {% endcomment %}
                
                <div class="button-container">
                    <div class="variant-item" style='display:flex;'>
                        <form method="POST" action="{% url 'add_to_cart' %}">
                            {% csrf_token %}

                            <!-- Hidden input for the selected variant ID for the cart -->
                            <input type="hidden" id="cart_variant_id" name="variant_id"  value="{{ default_variant.id }}">
                            

                            <button type="submit" class="add-to-cart-button">Add to Cart</button>
                        </form>

                        <form method="POST" action="{% url 'checkout' %}"> <!-- Replace 'checkout' with your actual checkout URL name -->
                            {% csrf_token %}
                            <!-- Hidden input for the selected variant ID for checkout -->
                            <input type="hidden" name="variant_id" value="{{ default_variant.id }}">
                            
                            
                            <button type="submit" class="shop-now-button" style='width:300px;'>Shop Now</button>
                        </form>  
                    </div>
                                 
                 </div>
 


  




</div> 
    </div>


 
<!-- Product Specifications Section -->
<section class="product-specifications">
    <h2>Product Specifications</h2>
    <table>
        <tr>
            <th>Feature</th>
            <th>Details</th>
        </tr>
        <tr>
            <td>Materials</td>
            <td>
                {% if materials %}
                    {{ materials|join:", " }} <!-- Display materials separated by commas -->
                {% else %}
                    Not specified
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>Colors</td>
            <td>
                {% if unique_colors %}
                    {{ unique_colors|join:", " }} <!-- Display colors separated by commas -->
                {% else %}
                    Not specified
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>Dimensions</td>
            <td>{{ product.dimensions }}</td> <!-- Assuming you are including dimensions -->
        </tr>
        <!-- Add more specifications as needed -->
    </table>
</section>

<div class="banner">
	<div class="container">
		<h2>Special Offer!</h2>
		<p>Get 20% off on your first purchase. Use code: <strong>WELCOME20</strong></p>
		<a href="#shop" class="btn">Shop Now</a>
	</div>
</div>


<section class="comments-section">
    <h2>Customer Reviews</h2>
    
	<div class="reviews" id="reviews">
		{% for review in reviews %}
		<div class="review-item">
			<div class="review-header">
				<div class="review-author">{{ review.name }}</div>
				<div class="review-rating">
					{% for i in star_range %}
						{% if i <= review.rating %}
							<i class="fas fa-star"></i>
						{% else %}
							<i class="far fa-star"></i>
						{% endif %}
					{% endfor %}
				</div>
			</div>
			<p class="review-text">{{ review.comment }}</p>
		</div>
		{% endfor %}
	</div>
	
	
	
    <hr class="divider">

    <!-- Review Submission Interface -->
    <div class="review-form">
        <h3>Leave a Review</h3>
		<div id="review-message" class="review-message"></div> 
        <div>
            <label for="name">Your Name</label>
            <input type="text" id="name" required>

            <label for="rating">Your Rating</label>
            <select id="rating" required>
                <option value="5">5 Stars</option>
                <option value="4">4 Stars</option>
                <option value="3">3 Stars</option>
                <option value="2">2 Stars</option>
                <option value="1">1 Star</option>
            </select>

            <label for="comment">Your Review</label>
            <textarea id="comment" rows="4" required></textarea>

            <button id="submit-review" class="submit-btn">Submit Review</button>
        </div>
    </div>
</section>
<section class="product-faq">
    <h2>Frequently Asked Questions</h2>
	{% for question in answered_questions %}
    <div class="faq-item">
        <h4>{{ question.question }} <span style="font-size: 14px; color: #555;margin-left:400px">(Asked by: {{ question.username }})</span></h4>
        <p style="margin-top: 15px; margin-left:15px">{{ question.answer }}</p>
    </div>
{% empty %}
    <p>No questions answered yet.</p>
{% endfor %}
    <!-- Add more FAQs as needed -->

    <!-- Ask a Question Form -->
	<div class="faq-question-form" style='display: flex;    flex-direction: column;'>
		<h3>Have a question?</h3>
		<form id="questionForm">
			<input type="hidden" id="productId" name="product_id" value="{{ product.id }}"> <!-- Assuming you have access to the product ID in the template -->

			<label for="question">Your Question</label>
			<textarea id="question" name="question" rows="4" required></textarea>
	
			<label for="email">Your Email</label>
			<input type="email" id="email" name="email" required placeholder="Enter your email">
	
			<button type="submit">Submit Question</button>
		</form>
		<div id="form-message"></div> <!-- For success/error message -->
	</div>
</section>

 
<div class="related-products">
    <h2>Related Products</h2>
    <div class="related-product-grid">
        {% for item in related_products_with_images %}
        <div class="product-item">
            <a href="{% url 'singleproduct' item.product.id %}">
                {% if item.first_image %}
                    <img src="{{ item.first_image }}" alt="{{ item.product.name }}">
                {% else %}
                    <img src="{% static 'default-image.jpg' %}" alt="No Image Available">
                {% endif %}
                <p class="product-name">{{ item.product.name }}</p>
                <p class="product-price">
                    ${{ item.product.price }}
                </p>
            </a>
        </div>
        {% endfor %}
    </div>
</div>



 
<script src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/10.2.0/decimal.min.js"></script>

<script>

    const variants = [
    {% for variant in variants %}
    {
        id: {{ variant.id }},
        color: "{{ variant.color }}",
        size: "{{ variant.size }}",
        type: "{{ variant.type1 }}",
        stock: {{ variant.stock }}
    },
    {% endfor %}
];

{% comment %} function updateVariant() {
    const selectedColor = document.getElementById('color').value;
    const selectedSize = document.getElementById('size').value;
    const selectedType = document.getElementById('type').value;

    // Find the variant that matches the selected options
    const selectedVariant = variants.find(variant => 
        variant.color === selectedColor && 
        variant.size === selectedSize && 
        variant.type === selectedType
    );

    // Update the hidden variant ID and max quantity based on the selected variant
    if (selectedVariant) {
        document.getElementById('variant_id').value = selectedVariant.id;
        document.getElementById('quantity').max = selectedVariant.stock; // Update max stock
        if (parseInt(document.getElementById('quantity').value) > selectedVariant.stock) {
            document.getElementById('quantity').value = selectedVariant.stock; // Adjust quantity if needed
        }
    }
} {% endcomment %}

{% comment %} function updateVariant() {
    const selectedColor = document.getElementById('color').value;
    const selectedSize = document.getElementById('size').value;
    const selectedType = document.getElementById('type').value;

    // Initialize the selected variant ID to null
    let selectedVariantId = null;

    // Loop through the variants to find the matching ID
    {% for variant in variants %}
        if ("{{ variant.color }}" === selectedColor && "{{ variant.size }}" === selectedSize && "{{ variant.type1 }}" === selectedType) {
            selectedVariantId = "{{ variant.id }}"; // Set the ID of the selected variant
        }
    {% endfor %}

    // Set the hidden input fields with the selected variant ID
    document.getElementById('selected_variant_id').value = selectedVariantId;
    document.getElementById('cart_variant_id').value = selectedVariantId;
} {% endcomment %}

function changeQuantity(change) {
    const quantityInput = document.getElementById('quantity');
    let currentQuantity = parseInt(quantityInput.value);
    const newQuantity = currentQuantity + change;

    // Ensure quantity stays within limits
    if (newQuantity >= 1 && newQuantity <= parseInt(quantityInput.max)) {
        quantityInput.value = newQuantity;
    }
}






   const variantsData = {{ variants_data|safe }}; // Ensure this is properly passed to JavaScript

function updateVariant() {
    const selectedColor = document.getElementById('color').value;
    const selectedSize = document.getElementById('size').value;
    const selectedType = document.getElementById('type').value;
    const sizeSelect = document.getElementById('size');
    const mainImage = document.getElementById('main-image');
    const thumbnailImagesContainer = document.getElementById('thumbnail-images');
    const priceElement = document.getElementById('price');
    const descriptionElement = document.getElementById('description');
    const stockElement = document.getElementById('stock');
                                                                               // Reference to the hidden input
    const selectedVariantIdInput = document.getElementById('cart_variant_id');
    // Clear current options and images
    sizeSelect.innerHTML = '';
    thumbnailImagesContainer.innerHTML = ''; // Clear existing thumbnails

    // Filter variants based on selected color
    const colorFilteredVariants = variantsData.filter(variant => variant.colour === selectedColor);

    // Populate Size Dropdown
    const uniqueSizes = [...new Set(colorFilteredVariants.map(v => v.size))];
    uniqueSizes.forEach(size => {
        const option = document.createElement('option');
        option.value = size;
        option.innerText = size;
        sizeSelect.appendChild(option);
    });

    // Populate Type Dropdown
    const uniqueTypes = [...new Set(colorFilteredVariants.map(v => v.type1))];
    const typeSelect = document.getElementById('type');
    typeSelect.innerHTML = ''; // Clear existing types
    uniqueTypes.forEach(type => {
        const option = document.createElement('option');
        option.value = type;
        option.innerText = type;
        typeSelect.appendChild(option);
    });

    // Further filter based on selected size and type
    const sizeFilteredVariants = colorFilteredVariants.filter(variant =>
        (variant.size === selectedSize || selectedSize === "") && // Include if size matches or no size selected
        (variant.type1 === selectedType || selectedType === "") // Include if type matches or no type selected
    );

    // Update Product Details if there are any filtered variants
    if (sizeFilteredVariants.length > 0) {
        const selectedVariant = sizeFilteredVariants[0]; // Use the first variant for details
        mainImage.src = selectedVariant.images[0].image; // Update main image to first image of the variant
        priceElement.textContent = `$${selectedVariant.price}`; // Update price
        descriptionElement.textContent = selectedVariant.description; // Update description
        stockElement.textContent = `In Stock: ${selectedVariant.stock}`; // Update stock
        selectedVariantIdInput.value = selectedVariant.id;



        
        // Populate Thumbnail Images
        selectedVariant.images.forEach(imgObj => {
            const imgElement = document.createElement('img');
            imgElement.src = imgObj.image; // Use the image URL
            imgElement.alt = "Thumbnail";
            imgElement.className = "thumbnail";
            imgElement.onclick = function() {
                updateMainImage(imgObj.image); // Update main image on click
            };
            thumbnailImagesContainer.appendChild(imgElement);
        });


        
    } else {
        // If no matching variants, you can clear the displayed details or show a message
        mainImage.src = ''; // Clear the main image
        priceElement.textContent = '';
        descriptionElement.textContent = '';
        stockElement.textContent = '';
        selectedVariantIdInput.value = '';
    }
} 

function updateMainImage(imageSrc) {
    const mainImage = document.getElementById('main-image');
    mainImage.src = imageSrc; // Update the main image source to the selected thumbnail
}

// Initial load of sizes and types based on the default variant
window.onload = function() {
    updateVariant();
};

// Add event listeners to update the variant when selections change
document.getElementById('color').addEventListener('change', updateVariant);
document.getElementById('size').addEventListener('change', updateVariant);
document.getElementById('type').addEventListener('change', updateVariant);


$(document).ready(function() {
    $("#main-image").elevateZoom({
        zoomType: "lens", // Use "window" for a window zoom or "lens" for a lens zoom
        lensShape: "square", // Can be "round" or "square"
        lensSize: 200 ,
		  // Increase the size of the lens (default was 300)
    });

    // Function to update the main image
    window.updateMainImage = function(newSrc) {
        $("#main-image").attr("src", newSrc).data("zoom-image", newSrc).elevateZoom({
            zoomType: "lens",
            lensShape: "square",
            lensSize: 200 ,
			 // Ensure the lens size is consistent when updating the image
        });
    };
});


const productId = {{ product.id }}; 
document.getElementById('submit-review').addEventListener('click', function(event) {
    //event.preventDefault();
	 // Prevent the default form submission

    // Gather input values
    const name = document.getElementById('name').value;
    const rating = document.getElementById('rating').value;
    const comment = document.getElementById('comment').value;

    // Fetch API to send the review
    fetch(`/auth/submit_review/${productId}/`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRFToken': '{{ csrf_token }}', // Make sure to replace with the CSRF token in your template context
        },
        body: new URLSearchParams({
            'name': name,
            'rating': rating,
            'comment': comment
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Handle the successful review submission
			location.reload();
			reviewMessage.innerText = "Review submitted successfully!";
            reviewMessage.classList.add("success-message");
            reviewMessage.classList.remove("error-message");
            // Optionally, you can reset the form or update the UI to show the new review
        } else {
            alert('Failed to submit review. Please try again.');
			reviewMessage.innerText = "Failed to submit the review. Please try again.";
            reviewMessage.classList.add("error-message");
            reviewMessage.classList.remove("success-message");
        }
    })
	.catch(error => {
        reviewMessage.innerText = "An error occurred. Please try again later.";
        reviewMessage.classList.add("error-message");
        reviewMessage.classList.remove("success-message");
    });
});

 

 




function getCookie(name) {
	let cookieValue = null;
	if (document.cookie && document.cookie !== '') {
		const cookies = document.cookie.split(';');
		for (let i = 0; i < cookies.length; i++) {
			const cookie = cookies[i].trim();
			if (cookie.substring(0, name.length + 1) === (name + '=')) {
				cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
				break;
			}
		}
	}
	return cookieValue;
}

document.getElementById('questionForm').addEventListener('submit', function (event) {
    event.preventDefault();  // Prevent the default form submission

    const question = document.getElementById('question').value;
    const email = document.getElementById('email').value; 
	const productId = document.getElementById('productId').value; // Retrieve email field
    const responseMessage = document.getElementById('responseMessage');
     
    fetch('/management/submit_question/',{
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRFToken': getCookie('csrftoken'),  // Include CSRF token
        },
        body: new URLSearchParams({
            'question': question,
            'email': email ,
			'product_id': productId  // Include 'email' in the POST request
        })
    })
    .then(response => {
         
    })
    .then(data => {
        if (responseMessage) {
            responseMessage.innerText = data.message || data.error;
        }
        // Delay the reload to let user see the message briefly
        setTimeout(() => {
            window.location.reload();  // Refresh the page after a brief delay
        }, 1000);
    })
    .catch(error => {
        if (responseMessage) {
            responseMessage.innerText = 'Error: ' + error.message;
        }
    });
});

let cart = []; // This will hold your cart items

function toggleCart() {
    const cartElement = document.getElementById('cart');
    cartElement.classList.toggle('open'); // Toggle off-canvas open class
}

function addToCart(productId, productName, productPrice) {
    const itemIndex = cart.findIndex(item => item.id === productId);

    if (itemIndex > -1) {
        // Item already in cart, increase quantity
        cart[itemIndex].quantity++;
    } else {
        // Add new item to cart
        cart.push({ id: productId, name: productName, price: productPrice, quantity: 1 });
    }
    
    updateCartDisplay();
}

function updateCartDisplay() {
    const cartItemsContainer = document.getElementById('cart-items');
    cartItemsContainer.innerHTML = ''; // Clear current items
    let total = 0;

    cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;

        cartItemsContainer.innerHTML += `
            <div class="cart-item">
                <span>${item.name} (x${item.quantity}) - $${itemTotal.toFixed(2)}</span>
                <button onclick="removeFromCart(${item.id})">Remove</button>
            </div>
        `;
    });

    document.getElementById('cart-total').innerText = total.toFixed(2); // Update total price
}

function removeFromCart(productId) {
    cart = cart.filter(item => item.id !== productId);
    updateCartDisplay();
}

function updateMainImage(imageSrc) {
    document.getElementById('main-image').src = imageSrc;
}





</script>

</body>
</html>
{% endblock %}